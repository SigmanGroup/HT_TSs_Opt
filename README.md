# High-Throughput Optimization and Featurization of TSs and Catalytic Cycle Intermediates
This repository contains scripts for high-throughput generation, optimization, and featurization of TSs and catalytic cycle intermediates, along with scripts for MLR modeling and Excel spreadsheet with input data.

## Dependencies
This workflow relies of published computational tools, including [AaronTools](https://aarontools.readthedocs.io/en/latest/index.html)<sup>1</sup> and [Molassembler](https://github.com/qcscine/molassembler)<sup>2</sup>. See the links for detailed installation guides.

## Step 1: Templates Generation
With the following specified in a .bashrc file (or similar)

```
export PYTHONPATH=/home/$USER/AARON_TOOLS/:$PYTHONPATH
export PATH=$PATH:/home/$USER/AARON_TOOLS/AaronTools/bin
```
A Bash script like this may be used to iterate through a .txt file containing the names of the ligands to map onto the templates (here, IntC_R.xyz and IntC_S.xyz):

```
#!/bin/bash
# Check if a filename argument is provided
if [ -z "$1" ]; then
  echo "Usage: $0 filename.txt"
  exit 1
  fi

# Loop through each line in the provided text file
while IFS= read -r file_id
do
  mapLigand.py IntC_R.xyz -l 45,46="$file_id" -o "${file_id}_IntC_R.xyz"
  mapLigand.py IntC_S.xyz -l 45,46="$file_id" -o "${file_id}_IntC_S.xyz"
done < "$1"
```

.xyz files of the ligands are located in /AARON_TOOLS/AaronTools/Ligands, while IntC_R.xyz and IntC_R.xyz are pre-optimized templates (at a DFT level of theory or at the GFN2-xTB level) of the two diastereometic L*Ni(III)(C-_sp_<sup>2</sup>)(C-_sp_<sup>3</sup>)X intermediates. The script can be adapted to generate templates for TSRE_R.xyz/TSRE_S.xyz, or to modify the substrates using the substitute.py script of AaronTools. Structures generated by AaronTools should be manually checked (with Jmol, Molden, or any other visualization software) to ensurure that no clashes between atoms exist, and then optimized at the GFN2-xTB level with key bonds and angles being constrained (details are provided [elsewhere](https://xtb-docs.readthedocs.io/en/latest/xcontrol.html#fixing-constraining-and-confining)). To ensure that the atom indices of the common chemical motif are conserved throughout all the structures generated by AaronTools, the following Bash script is used to re-order the atom indices prior to optimization (list.txt is a text file containing the atom indices of the structures generated by AaronTools ordered according to the desired output _e.g._, if the atom labelled 30 should become 1, then it must be listed first in list.txt):

```
#!/bin/bash

# Validate input arguments
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 path/to/list.txt"
    exit 1
fi

list_file="$1"

# Process each .xyz file in the directory
for file in *.xyz; do
    echo "Processing $file..."

    # Create a temporary file for the reordered content
    temp_file="${file%.xyz}_reordered.xyz"

    # Read the first two lines and write them to the temporary file
    head -n 2 "$file" > "$temp_file"

    # Read the reordering indices from list.txt and adjust by adding 2
    mapfile -t order < <(awk '{print $1 + 2}' "$list_file")

    # Create an associative array to mark lines that need reordering
    declare -A is_reordered
    for index in "${order[@]}"; do
        is_reordered[$index]=1
    done

    # Append reordered lines as per the list
    for line_number in "${order[@]}"; do
        sed -n "${line_number}p" "$file"
    done >> "$temp_file"

    # Calculate total lines in the file
    total_lines=$(wc -l < "$file")

    # Append remaining lines that are not reordered
    for ((i=3; i<=total_lines; i++)); do
        if [[ -z ${is_reordered[$i]} ]]; then
            sed -n "${i}p" "$file"
        fi
    done >> "$temp_file"

    # Replace the original file with the reordered file
    mv "$temp_file" "$file"
done

echo "All files have been processed."
```

## Citations
1. Ingman, V. M., Schaefer, A. J., Andreola, L. R. & Wheeler, S. E. QChASM: Quantum chemistry automation and structure manipulation. _WIREs Comput. Mol. Sci._ **11**, e1510 (2021)
2. Sobez, J.-G. & Reiher, M. Molassembler: Molecular Graph Construction, Modification, and Conformer Generation for Inorganic and Organic Molecules. _J. Chem. Inf. Model._ **60**, 3884â€“3900 (2020)

